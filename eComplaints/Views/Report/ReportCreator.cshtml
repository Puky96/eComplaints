@model eComplaints.Models.ReportViewModels.ReportCreatorModel
@{ 
    if (ViewBag.IsAdmin)
    {
        Layout = "~/Views/Shared/_Layout_Admin.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_Layout.cshtml";
    }

}
<link href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker.css" rel="stylesheet" />

<br />
<div class="row">
    <div class="col-md-12">
        <form asp-action="ReportCreator">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label asp-for="BeginDate" class="control-label col-md-4"></label>
                        <div class="input-group date" data-provider="datepicker">
                            <input asp-for="BeginDate" type="text" class="form-control" />
                            <div class="input-group-addon glyphicon glyphicon-th"></div>
                        </div>
                        <span asp-validation-for="BeginDate" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label asp-for="EndDate" class="control-label col-md-4"></label>
                        <div class="input-group date" data-provider="datepicker">
                            <input asp-for="EndDate" type="text" class="form-control" />
                            <div class="input-group-addon glyphicon glyphicon-th"></div>
                        </div>
                        <span asp-validation-for="EndDate" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <label asp-for="Department" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Department" class="form-control" asp-items="@ViewBag.Departments">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                        <span asp-validation-for="Department" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-md-6">
                    <label asp-for="Line" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Line" class="form-control">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                        <span asp-validation-for="Line" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-6">
                    <label asp-for="Suppplier" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Suppplier" class="form-control">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                    </div>
                    <span asp-validation-for="Suppplier" class="text-danger"></span>
                </div>
                <div class="form-group col-md-6">
                    <label asp-for="Status" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Status" class="form-control" asp-items="@ViewBag.Status">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                    </div>
                    <span asp-validation-for="Status" class="text-danger"></span>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-4">
                    <label asp-for="Approved" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Approved" class="form-control">
                            <option disabled selected>-----SELECT-----</option>
                            <option value=0>nu</option>
                            <option value=1>da</option>
                        </select>
                    </div>
                    <span asp-validation-for="Approved" class="text-danger"></span>
                </div>
                <div class="form-group col-md-4">
                    <label asp-for="Repeated" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Repeated" class="form-control">
                            <option disabled selected>-----SELECT-----</option>
                            <option value=0>nu</option>
                            <option value=1>da</option>
                        </select>
                    </div>
                    <span asp-validation-for="Repeated" class="text-danger"></span>
                </div>
                <div class="form-group col-md-4">
                    <label asp-for="MaterialBlocked" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="MaterialBlocked" class="form-control" asp-items="@ViewBag.MaterialBlockedCauses">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                    </div>
                    <span asp-validation-for="MaterialBlocked" class="text-danger"></span>
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-4">
                    <label asp-for="Issue" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Issue" class="form-control" asp-items="@ViewBag.Issues">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                        <span asp-validation-for="Issue" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-md-4">
                    <label asp-for="Brand" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Brand" class="form-control" asp-items="@ViewBag.Brand">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                        <span asp-validation-for="Brand" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group col-md-4">
                    <label asp-for="Size" class="control-label col-md-4"></label>
                    <div class="col-md-8">
                        <select asp-for="Size" class="form-control" asp-items="@ViewBag.Size">
                            <option disabled selected>-----SELECT-----</option>
                        </select>
                        <span asp-validation-for="Size" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label asp-for="GCAS" class="control-label"></label>
                <input asp-for="GCAS" class="form-control" />
                <span asp-validation-for="GCAS" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Vezi raport" class="btn btn-info btn-block" />
            </div>
        </form>
    </div>
</div>

<br />

@Html.AjaxGrid(Url.Action("_ReportGrid", "Report", new { beginDate = Model.BeginDate,
    endDate = Model.EndDate,
    department = Model.Department,
    line = Model.Line,
    supplier = Model.Suppplier,
    status = Model.Status,
    approved = Model.Approved,
    repeated = Model.Repeated,
    materialBlocked = Model.MaterialBlocked, 
    issue = Model.Issue,
    brand = Model.Brand,
    size = Model.Size,
    gcas = Model.GCAS
}))

<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.js"></script>
<script src="~/js/MvcGrid/mvc-grid.js"></script>

<script>
    $('#BeginDate').datepicker();
    $('#EndDate').datepicker();
    $('.mvc-grid').mvcgrid();

    $(document).ready(function () {
        $.get("/Report/RetrieveAreas", { departmentId: $("#Department").val() }, function (data) {
            $("#Line").empty();
            $("#Line").append("<option disabled selected>-----SELECT-----</option>")
            $.each(data, function (index, row) {
                $("#Line").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })

        $.get("/Report/RetrieveSuppliers", { departmentId: $("#Department").val() }, function (data) {
            $("#Suppplier").empty();
            $("#Suppplier").append("<option value ='" + null + "'>" + '-----SELECT-----' + "</option>")
            $.each(data, function (index, row) {
                $("#Suppplier").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })

        $.get("/Report/RetrieveIssues", { departmentId: $("#Department").val() }, function (data) {
            $("#Issue").empty();
            $("#Issue").append("<option value ='" + null + "'>" + '-----SELECT-----' + "</option>")
            $.each(data, function (index, row) {
                $("#Issue").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })
    })

    $("#Department").change(function () {
        $.get("/Report/RetrieveAreas", { departmentId: $("#Department").val() }, function (data) {
            $("#Line").empty();
            $("#Line").append("<option disabled selected>-----SELECT-----</option>")
            $.each(data, function (index, row) {
                $("#Line").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })
    })

    $("#Department").change(function () {
        $.get("/Report/RetrieveSuppliers", { departmentId: $("#Department").val() }, function (data) {
            $("#Suppplier").empty();
            $("#Suppplier").append("<option value ='" + null + "'>" + '-----SELECT-----' + "</option>")
            $.each(data, function (index, row) {
                $("#Suppplier").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })
    })

    $("#Department").change(function () {
        $.get("/Report/RetrieveIssues", { departmentId: $("#Department").val() }, function (data) {
            $("#Issue").empty();
            $("#Issue").append("<option value ='" + null + "'>" + '-----SELECT-----' + "</option>")
            $.each(data, function (index, row) {
                $("#Issue").append("<option value ='" + row.id + "'>" + row.equipmentName + "</option>")
            })
        })
    })

</script>
